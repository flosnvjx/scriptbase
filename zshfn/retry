retry() {
  if [[ $# -lt 2 || $#2 -eq 0 ]]; then return 128; fi
  integer +x __retry_status=
  repeat 1+"$1" {
    if "${(@)argv[2,-1]}"; then
      __retry_status=$?
      break
    else
      __retry_status=$?
    fi
  }
  return $__retry_status
}
